---
title: "Ching’s RMD"
author: "Ching"
date: "September 27, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(dplyr)
library(ggplot2)
amen<-select(data_short,contains("amen_"))
amen_name<-colnames(amen)
number<-colMeans(amen[, (1:53)], na.rm=TRUE)
data<-as.data.frame(amen_name)
data$number=number
data_remove_amen<-data[-c(44,6,7,29,39,43),]
arrange(data_remove_amen,desc(number))

```

data1<-data[,c(-44,-6,-7,-29,-39,-43)]

#Amenity
In AirBnB, landlords offer different amenities for the tenants, including Wifi, kitchen, washer, even shampoo, and etc, and those facilities will be showed in the webpages for tenants’ references. Out of 53,844 offerings of rooms in London, internet connections are the most important elements in room. There are 95% of the rooms offering Wifi and internet connection. Besides, some general amenities for houses such as heating facilities (93%), kitchens (91%), essentials (83%), washers (83%), TV (67%), hangers (60%), Iron (59%), and shampoo (57%), will often be provided in houses/rooms. However, in London, most of the offerings don’t allow their customers to smoke and to brings their pets with them.  77% of rooms are with smoke detectors, and less than 10% of rooms are smoking allowed and pets allowed. Due to the weather in London, air-con facility seems not important, but this will be a must in most of the Asian countries. 

```{r}
ggplot(data_remove_amen,aes(x =reorder(amen_name, -number),y=number))+geom_col()+theme(axis.text = element_text(angle= 90, hjust = 1))+labs(x = "amen_name",y="number")
```

# Amenity doesn’t significant affected the numbers of reviews and rating, even price 

To discover the importance of amenities, we choose 47 variables of amenities to test the relationship to score of rating (1 to 100), and score of value (1 to 10). (We deleted some of the missing variables and some inappropriate variables. For example, no records show in variable “Cat(s)” or “Dogs(s)”.) The main finding is that the amenities may not explain the variation of the rating scores and the values for customers and even price. Adjust R-square for both factors are only 0.04 to 0.1. However, we can still find the correlations between those amenities variables and rating/value from customers. Some of the interesting findings may be the offering of kitchens and safety-related amenities such as fire-extinguishers, lock of the bedroom or safety cards seems negatively impact on the overall rating and perceived value of rooms, and the family-and-kid-friendly environment is also negative to the value of room. The reason may be that the inconvenience of those safety amenities outweighs the safety and it also charge higher. The family-and-kid-friendly environment may also indicated a noisy and messy environment, which is also significantly negative to score of cleanliness and has a negative impact on price. 

```{r}
ggplot(data_amen,aes(x=amen_Smoke_detector,y=price_pp))+geom_boxplot()
ggplot(data_amen,aes(x=amen_TV,y=price_pp))+geom_boxplot()
ggplot(data_amen,aes(x=amen_Hangers,y=price_pp))+geom_boxplot()
ggplot(data_amen,aes(x=amen_Iron,y=price_pp))+geom_boxplot()
ggplot(data_amen,aes(x=amen_Shampoo,y=price_pp))+geom_boxplot()
ggplot(data_amen,aes(x=amen_Family_kid_friendly,y=price_pp))+geom_boxplot()
ggplot(data_amen,aes(x=amen_Hair_dryer,y=price_pp))+geom_boxplot()
ggplot(data_amen,aes(x=amen_Laptop_friendly_workspace,y=price_pp))+geom_boxplot()
ggplot(data_amen,aes(x=amen_Carbon_monoxide_detector,y=price_pp))+geom_boxplot()
ggplot(data_amen,aes(x=amen_Dryer,y=price_pp))+geom_boxplot()
ggplot(data_amen,aes(x=amen_First_aid_kit,y=price_pp))+geom_boxplot()
ggplot(data_amen,aes(x=amen_Buzzer_wireless_intercom,y=price_pp))+geom_boxplot()
ggplot(data_amen,aes(x=amen_Fire_extinguisher,y=price_pp))+geom_boxplot()
```

```{r}
ggplot(data_amen2,aes(x=amen_Smoke_detector,y=review_scores_rating))+geom_boxplot()
ggplot(data_amen2,aes(x=amen_TV,y=review_scores_rating))+geom_boxplot()
ggplot(data_amen2,aes(x=amen_Hangers,y=review_scores_rating))+geom_boxplot()
ggplot(data_amen2,aes(x=amen_Iron,y=review_scores_rating))+geom_boxplot()
ggplot(data_amen2,aes(x=amen_Shampoo,y=review_scores_rating))+geom_boxplot()
ggplot(data_amen2,aes(x=amen_Family_kid_friendly,y=review_scores_rating))+geom_boxplot()
ggplot(data_amen2,aes(x=amen_Hair_dryer,y=review_scores_rating))+geom_boxplot()
ggplot(data_amen2,aes(x=amen_Laptop_friendly_workspace,y=review_scores_rating))+geom_boxplot()
ggplot(data_amen2,aes(x=amen_Carbon_monoxide_detector,y=review_scores_rating))+geom_boxplot()
ggplot(data_amen2,aes(amen_Dryer,y=review_scores_rating))+geom_boxplot()
ggplot(data_amen2,aes(x=amen_First_aid_kit,y=review_scores_rating))+geom_boxplot()
ggplot(data_amen2,aes(x=amen_Buzzer_wireless_intercom,y=review_scores_rating))+geom_boxplot()
ggplot(data_amen2,aes(x=amen_Fire_extinguisher,y=review_scores_rating))+geom_boxplot()

```

```{r}
ggplot(data_amen3,aes(x=amen_Smoke_detector,y=review_scores_value))+geom_boxplot()
ggplot(data_amen3,aes(x=amen_TV,y=review_scores_value))+geom_boxplot()
ggplot(data_amen3,aes(x=amen_Hangers,y=review_scores_value))+geom_boxplot()
ggplot(data_amen3,aes(x=amen_Iron,y=review_scores_value))+geom_boxplot()
ggplot(data_amen3,aes(x=amen_Shampoo,y=review_scores_value))+geom_boxplot()
ggplot(data_amen3,aes(x=amen_Family_kid_friendly,y=review_scores_value))+geom_boxplot()
ggplot(data_amen3,aes(x=amen_Hair_dryer,y=review_scores_value))+geom_boxplot()
ggplot(data_amen3,aes(x=amen_Laptop_friendly_workspace,y=review_scores_value))+geom_boxplot()
ggplot(data_amen3,aes(x=amen_Carbon_monoxide_detector,y=review_scores_value))+geom_boxplot()
ggplot(data_amen3,aes(amen_Dryer,y=review_scores_value))+geom_boxplot()
ggplot(data_amen3,aes(x=amen_First_aid_kit,y=review_scores_value))+geom_boxplot()
ggplot(data_amen3,aes(x=amen_Buzzer_wireless_intercom,y=review_scores_value))+geom_boxplot()
ggplot(data_amen3,aes(x=amen_Fire_extinguisher,y=review_scores_value))+geom_boxplot()





```

```{r}

```


```{r}
library(plyr)
rating<-list("number_of_reviews","review_scores_rating","review_scores_value")
rating1<-unlist(rating)
amen_list<-list(amen_name)
amen_list1<-unlist(amen_list)
data.cor<-select(data_short,contains("amen_"),price_pp,number_of_reviews,review_scores_rating,review_scores_value,review_scores_cleanliness)%>%filter(!is.na(number_of_reviews),!is.na(review_scores_rating),!is.na(review_scores_value),!is.na(review_scores_cleanliness))
data_amen1<-rename(data.cor,c("amen_24-hour_check-in"="amen_24_hour_check_in","amen_Washer_/_Dryer"="amen_Washer_Dryer","amen_Family/kid_friendly"="amen_Family_kid_friendly","amen_Buzzer/wireless_intercom"="amen_Buzzer_wireless_intercom","amen_Cat(s)"="amen_Cat","amen_Dog(s)"="amen_Dog","amen_Other_pet(s)"="amen_Other_pet","amen_Self_Check-In"="amen_Self_Check_In"))
data_amen<-filter(data_amen1,price_pp<=150)
data_amen2<-filter(data_amen,review_scores_rating>=80)
data_amen3<-filter(data_amen,review_scores_value>=8)
```

```{r}
NSR<-lm(review_scores_rating~amen_Wireless_Internet
+amen_Kitchen
+amen_Washer
+amen_Smoke_detector
+amen_Laptop_friendly_workspace
+amen_TV
+amen_Internet
+amen_Free_parking_on_premises
+amen_Elevator_in_building
+amen_Heating
+amen_Family_kid_friendly
+amen_Essentials
+amen_Carbon_monoxide_detector
+amen_Hangers
+amen_Cable_TV
+amen_Indoor_fireplace
+amen_Dryer
+amen_First_aid_kit
+amen_24_hour_check_in
+amen_Hair_dryer
+amen_Iron
+amen_Breakfast
+amen_Shampoo
+amen_Pets_allowed
+amen_Gym
+amen_Pets_live_on_this_property
+amen_Suitable_for_events
+amen_Private_living_room
+amen_Private_entrance
+amen_Lock_on_bedroom_door
+amen_Fire_extinguisher
+amen_Smoking_allowed
+amen_Safety_card
+amen_Hot_tub
+amen_Buzzer_wireless_intercom
+amen_Wheelchair_accessible
+amen_Air_conditioning
+amen_Doorman
+amen_Self_Check_In
+amen_Smartlock
+amen_Keypad
+amen_Lockbox
+amen_Doorman_Entry
+amen_Pool
+amen_Washer_Dryer
+amen_Free_parking_on_street
+amen_Paid_parking_off_premises
,data=data_amen)
summary(NSR)

NSV<-lm(review_scores_value~amen_Wireless_Internet
+amen_Kitchen
+amen_Washer
+amen_Smoke_detector
+amen_Laptop_friendly_workspace
+amen_TV
+amen_Internet
+amen_Free_parking_on_premises
+amen_Elevator_in_building
+amen_Heating
+amen_Family_kid_friendly
+amen_Essentials
+amen_Carbon_monoxide_detector
+amen_Hangers
+amen_Cable_TV
+amen_Indoor_fireplace
+amen_Dryer
+amen_First_aid_kit
+amen_24_hour_check_in
+amen_Hair_dryer
+amen_Iron
+amen_Breakfast
+amen_Shampoo
+amen_Pets_allowed
+amen_Gym
+amen_Pets_live_on_this_property
+amen_Suitable_for_events
+amen_Private_living_room
+amen_Private_entrance
+amen_Lock_on_bedroom_door
+amen_Fire_extinguisher
+amen_Smoking_allowed
+amen_Safety_card
+amen_Hot_tub
+amen_Buzzer_wireless_intercom
+amen_Wheelchair_accessible
+amen_Air_conditioning
+amen_Doorman
+amen_Self_Check_In
+amen_Smartlock
+amen_Keypad
+amen_Lockbox
+amen_Doorman_Entry
+amen_Pool
+amen_Washer_Dryer
+amen_Free_parking_on_street
+amen_Paid_parking_off_premises
,data=data_amen)
summary(NSV)

NSC<-lm(review_scores_cleanliness~
+amen_Kitchen
+amen_Washer
+amen_Smoke_detector
+amen_Family_kid_friendly
+amen_Essentials
+amen_Carbon_monoxide_detector
+amen_Indoor_fireplace
+amen_Dryer
+amen_First_aid_kit
+amen_24_hour_check_in
+amen_Hair_dryer
+amen_Iron
+amen_Breakfast
+amen_Shampoo
+amen_Pets_allowed
+amen_Gym
+amen_Pets_live_on_this_property
+amen_Suitable_for_events
+amen_Private_living_room
+amen_Private_entrance
+amen_Lock_on_bedroom_door
+amen_Fire_extinguisher
+amen_Smoking_allowed
+amen_Safety_card
+amen_Hot_tub
+amen_Buzzer_wireless_intercom
+amen_Wheelchair_accessible
+amen_Air_conditioning
+amen_Doorman
+amen_Self_Check_In
+amen_Smartlock
+amen_Keypad
+amen_Lockbox
+amen_Doorman_Entry
+amen_Pool
+amen_Washer_Dryer
,data=data_amen)
summary(NSC)


PRICE<-lm(price_pp~amen_Wireless_Internet
+amen_Kitchen
+amen_Washer
+amen_Smoke_detector
+amen_Laptop_friendly_workspace
+amen_TV
+amen_Internet
+amen_Free_parking_on_premises
+amen_Elevator_in_building
+amen_Heating
+amen_Family_kid_friendly
+amen_Essentials
+amen_Carbon_monoxide_detector
+amen_Hangers
+amen_Cable_TV
+amen_Indoor_fireplace
+amen_Dryer
+amen_First_aid_kit
+amen_24_hour_check_in
+amen_Hair_dryer
+amen_Iron
+amen_Breakfast
+amen_Shampoo
+amen_Pets_allowed
+amen_Gym
+amen_Pets_live_on_this_property
+amen_Suitable_for_events
+amen_Private_living_room
+amen_Private_entrance
+amen_Lock_on_bedroom_door
+amen_Fire_extinguisher
+amen_Smoking_allowed
+amen_Safety_card
+amen_Hot_tub
+amen_Buzzer_wireless_intercom
+amen_Wheelchair_accessible
+amen_Air_conditioning
+amen_Doorman
+amen_Self_Check_In
+amen_Smartlock
+amen_Keypad
+amen_Lockbox
+amen_Doorman_Entry
+amen_Pool
+amen_Washer_Dryer
+amen_Free_parking_on_street
+amen_Paid_parking_off_premises
,data=data_amen)
summary(PRICE)

```

```{r}
NOR<-lm(number_of_reviews~
amen_Internet
+amen_Wireless_Internet		
+amen_Heating		
+amen_Kitchen		
+amen_Essentials
+amen_Washer		
+amen_Smoke_detector		
+amen_TV		
+amen_Hangers		
+amen_Iron
,data=data_amen)
summary(NOR)

NSR<-lm(review_scores_rating~
amen_Internet
+amen_Wireless_Internet		
+amen_Heating		
+amen_Kitchen		
+amen_Essentials
+amen_Washer		
+amen_Smoke_detector		
+amen_TV		
+amen_Hangers		
+amen_Iron
,data=data_amen)
summary(NSR)

NSV<-lm(review_scores_value~
amen_Internet
+amen_Wireless_Internet		
+amen_Heating		
+amen_Kitchen		
+amen_Essentials
+amen_Washer		
+amen_Smoke_detector		
+amen_TV		
+amen_Hangers		
+amen_Iron
,data=data_amen)
summary(NSV)

PRICE<-lm(price_pp~
            amen_Internet
+amen_Wireless_Internet		
+amen_Heating		
+amen_Kitchen		
+amen_Essentials
+amen_Washer		
+amen_Smoke_detector		
+amen_TV		
+amen_Hangers		
+amen_Iron
,data=data_amen)
summary(PRICE)
```

```


##Test

This is for test. 

## MY Sandbox

This is where I do analysis
